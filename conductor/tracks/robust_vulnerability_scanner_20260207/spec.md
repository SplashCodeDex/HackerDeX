# Spec: Enhanced Robust Vulnerability Scanner & Intelligence Engine

## Overview
This track aims to significantly enhance HackerDeX's core scanning and analysis capabilities. It transforms the existing toolset into a unified, intelligent system by ensuring comprehensive support for all 55+ tools, leveraging Google Gemini for autonomous security tasks, and implementing strategic prioritization of findings in VulnStore based on potential impact and privilege escalation.

## Functional Requirements

### 1. Universal Tool Normalization (Parsing Engine)
- **Comprehensive Support:** Update the Parsing Engine to support raw output normalization for all 55+ tools currently in the `hackingtool` catalog.
- **Normalized Schema:** Ensure every tool's output is mapped to a standard schema in VulnStore (Targets, Ports, Services, Vulnerabilities, Metadata).
- **Asynchronous Processing:** Implement robust, non-blocking parsing to handle concurrent outputs from multiple tools.

### 2. Strategic AI Intelligence (Gemini Integration)
- **Automated Exploit Verification:** Implement a module that uses Gemini to generate safe, targeted Python scripts (using `requests`, `scapy`, etc.) to verify findings reported by any tool.
- **Intelligent Attack Pathing:** Use LLM analysis to correlate disparate findings and predict multi-step attack chains (e.g., Domain -> IP -> Service -> Exploit).
- **Autonomous Workflow Orchestration:** Implement a "Next Best Action" engine that suggests the most effective tool to run next based on gathered intelligence.

### 3. Advantage-Based Correlation & Prioritization (VulnStore)
- **Cross-Layer Mapping:** Automatically link intelligence across OSINT, Network, and Web layers to build a unified attack surface map.
- **Privilege-Centric Prioritization:** Implement a ranking algorithm that prioritizes findings based on:
    - **Potential Privilege Gain:** (e.g., RCE/Root > User Access > Information Disclosure).
    - **Strategic Advantage:** (e.g., Entry points that lead to internal network lateral movement).
- **High-Fidelity Deduplication:** Use cross-tool verification to eliminate false positives and group redundant findings.

## Non-Functional Requirements
- **Performance:** Parsing and correlation should not introduce significant latency to the overall scan workflow.
- **Reliability:** The engine must handle malformed or unexpected tool outputs gracefully without crashing.
- **Security:** AI-generated verification scripts must be sandboxed or clearly flagged for manual review to prevent accidental damage.

## Acceptance Criteria
- [ ] Parsing Engine successfully processes and normalizes output from a representative sample of all tool categories (Web, Network, OSINT, etc.).
- [ ] VulnStore correctly correlates and links findings from at least 3 different tool categories for a single target.
- [ ] The system provides a prioritized list of "High Advantage" targets/vulnerabilities.
- [ ] Gemini successfully generates a functional verification script for a detected vulnerability.
- [ ] The "Next Best Action" engine provides a logical tool recommendation after an initial scan.

## Out of Scope
- Implementation of brand new penetration testing tools (focus is on enhancing integration of existing ones).
- Real-time active exploitation (focus is on verification and pathing, not automated "hacks").
